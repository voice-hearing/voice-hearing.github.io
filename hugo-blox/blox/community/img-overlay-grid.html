{{/* Hugo Blox: Features */}}
{{/* Documentation: https://hugoblox.com/blocks/ */}}
{{/* License: https://github.com/HugoBlox/hugo-blox-builder/blob/main/LICENSE.md */}}

{{/* Initialise */}}
{{ $page := .wcPage }}
{{ $block := .wcBlock }}
{{ $title := $block.content.title | emojify | $page.RenderString }}
{{ $text := $block.content.text | emojify | $page.RenderString }}
{{ $blue := $block.content.blue | emojify | $page.RenderString }}

<section class="mx-auto max-w-7xl px-1 lg:px-0 pt-8 pb-8">

  <style>
    .overlay-bg-light {
      background-color: rgba(255, 255, 255, 0.9);
    }
    .overlay-bg-dark {
      background-color: rgba(0, 0, 0, 0.7);
    }
    .custom-drop-shadow-lg {
      text-shadow:
        2px 2px 4px rgba(0,0,0,0.9),
        -2px -2px 4px rgba(0,0,0,0.9),
        0 0 8px rgba(0,0,0,0.9);
    }
  </style>

  {{ $padding := cond (isset $block "design") (index $block.design.spacing.padding 0 | default "1rem") "1rem" }}
  {{ $margin := "1.5rem" }} <!-- Increased margin here -->

 <div class="mx-auto max-w-7xl mt-0 mb-4">
    
 <div class="flex flex-col">
  {{ with $blue }}
  <p class="mb-2 text-lg md:text-xl tracking-tight uppercase font-semibold text-primary-600 dark:text-primary-300">{{.}}</p>
  {{ end }}
  
  <div class="px-1 md:px-6 lg:px-0">
  <!-- Red horizontal line above title -->
  <div class="w-16 border-2 border-primary-700 mb-4 px-2"></div>
      
  {{ with $title }}
  <h2 class="mb-4 text-3xl font-bold dark:font-semibold text-gray-900 dark:text-white">{{.}}</h2>
  {{ end }}</div>
  {{ with $text }}
  <p class="text-xl md:text-2xl text-gray-500 dark:text-gray-400">{{.}}</p>
  {{ end }}
</div>

  <!-- Flex container for images -->
  <div class="flex flex-col md:flex-row w-full max-w-5xl mx-auto gap-4">

    <!-- Main image 2/3 width and fixed height -->
    {{ with index $block.content.slides 0 }}
      {{ $bg := .background }}
      {{ $bg_img := "" }}
      {{ if $bg.image.filename }}
        {{ $bg_img = resources.Get (printf "media/%s" $bg.image.filename) }}
        {{ if $bg_img }}
          {{ $bg_img = $bg_img.Fit "900x900 q70 webp" }}
        {{ end }}
      {{ end }}
      <a href="{{ .url }}" class="w-2/3 relative rounded-lg overflow-hidden shadow-lg">
        {{ if $bg_img }}
          <img src="{{ $bg_img.RelPermalink }}" alt="{{ .title | plainify }}" class="w-full h-[32rem] object-cover object-center" />
        {{ else }}
          <div class="w-full h-[32rem] bg-gray-400"></div>
        {{ end }}
        <div class="absolute bottom-0 left-0 overlay-bg-light dark:overlay-bg-dark rounded-lg"
             style="padding: {{ $padding }}; margin: {{ $margin }};">
          <h2 class="text-2xl md-text-3xl lg:text-3xl font-semibold text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-200 transition-colors duration-300">{{ .title }} <span class="text-primary-700">›</span></h2>
        </div>
      </a>
    {{ end }}

    <!-- Side images container 1/3 width stacked vertically -->
    <div class="w-1/3 flex flex-col gap-4">

      {{ with index $block.content.slides 1 }}
        {{ $bg := .background }}
        {{ $bg_img := "" }}
        {{ if $bg.image.filename }}
          {{ $bg_img = resources.Get (printf "media/%s" $bg.image.filename) }}
          {{ if $bg_img }}
            {{ $bg_img = $bg_img.Fit "450x440 q70 webp" }}
          {{ end }}
        {{ end }}
        <a href="{{ .url }}" class="relative rounded-lg overflow-hidden shadow-lg">
          {{ if $bg_img }}
            <img src="{{ $bg_img.RelPermalink }}" alt="{{ .title | plainify }}" class="w-full h-[16rem] object-cover object-center" />
          {{ else }}
            <div class="w-full h-[16rem] bg-gray-400"></div>
          {{ end }}
          <div class="absolute bottom-0 left-0 overlay-bg-light dark:overlay-bg-dark rounded-lg"
               style="padding: {{ $padding }}; margin: {{ $margin }};">
            <h2 class="text-2xl md-text-3xl lg:text-3xl font-semibold text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-200 transition-colors duration-300">{{ .title }} <span class="text-primary-700">›</span></h2>
          </div>
        </a>
      {{ end }}

      {{ with index $block.content.slides 2 }}
        {{ $bg := .background }}
        {{ $bg_img := "" }}
        {{ if $bg.image.filename }}
          {{ $bg_img = resources.Get (printf "media/%s" $bg.image.filename) }}
          {{ if $bg_img }}
            {{ $bg_img = $bg_img.Fit "450x440 q70 webp" }}
          {{ end }}
        {{ end }}
        <a href="{{ .url }}" class="relative rounded-lg overflow-hidden shadow-lg">
          {{ if $bg_img }}
            <img src="{{ $bg_img.RelPermalink }}" alt="{{ .title | plainify }}" class="w-full h-[16rem] object-cover object-center" />
          {{ else }}
            <div class="w-full h-[16rem] bg-gray-400"></div>
          {{ end }}
          <div class="absolute bottom-0 left-0 overlay-bg-light dark:overlay-bg-dark rounded-lg"
               style="padding: {{ $padding }}; margin: {{ $margin }};">
            <h2 class="text-2xl md-text-3xl lg:text-3xl font-semibold text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-200 transition-colors duration-300">{{ .title }} <span class="text-primary-700">›</span></h2>
          </div>
        </a>
      {{ end }}

    </div>

  </div>
</section>
