{{/* Hugo Blox: Pricing - Masonry Style with Sourced Button */}}
{{/* Documentation: https://hugoblox.com/blocks/ */}}
{{/* License: https://github.com/HugoBlox/hugo-blox-builder/blob/main/LICENSE.md */}}

{{/* Initialise */}}
{{ $page := .wcPage }}
{{ $block := .wcBlock }}
{{ $title := $block.content.title | emojify | $page.RenderString }}
{{ $text := $block.content.text | emojify | $page.RenderString }}
{{ $blue := $block.content.blue | emojify | $page.RenderString }}

<style>
  /* Link Colors for Light and Dark Theme */
  .markdown-content a {
    color: rgb(185 28 28); /* text-primary-700 equivalent */
    text-decoration: underline;
    transition: opacity 0.2s ease-in-out;
  }
  
  .markdown-content a:hover {
    opacity: 0.8;
  }
  
  .dark .markdown-content a {
    color: rgb(253 164 175); /* text-primary-300 equivalent */
  }
  
  /* Style links in the text content specifically */
  .content-text a {
    color: rgb(185 28 28); /* text-primary-700 */
    text-decoration: underline;
    font-weight: 500;
    transition: all 0.2s ease-in-out;
  }
  
  .content-text a:hover {
    opacity: 0.8;
  }
  
  .dark .content-text a {
    color: rgb(253 164 175); /* text-primary-300 */
  }
  /* MASONRY LAYOUT STYLES */
  .masonry-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    align-items: start; /* Key change: start instead of stretch */
  }

  @media (min-width: 640px) {
    .masonry-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }
  }

  @media (min-width: 768px) {
    .masonry-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 2rem;
    }
  }

  /* PRICING CARD ENHANCEMENTS */
  .pricing-card {
    height: fit-content; /* Allow natural height */
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .pricing-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
  }

  .dark .pricing-card:hover {
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  }
</style>

<section>
  
<div class="mx-auto max-w-7xl mt-0 px-1 lg:px-0 markdown-content">
  
  <!-- Header Section -->
  <div class="flex flex-col text-left">
    {{ with $blue }}
    <p class="mb-2 text-lg md:text-xl tracking-tight uppercase font-semibold text-primary-600 dark:text-primary-300">{{.}}</p>
    {{ end }}
  <div class="px-1 md:px-6 lg:px-0">
  <!-- Red horizontal line above title -->
  <div class="w-16 border-2 border-primary-700 mb-4 px-2"></div>
      
  {{ with $title }}
  <h2 class="mb-4 text-3xl font-bold text-gray-900 dark:text-white">{{.}}</h2>
  {{ end }}</div>
    
    {{ with $text }}
    <div class="text-xl text-gray-600 dark:text-gray-300 content-text">{{.}}</div>
    {{ end }}
  </div>

    <!-- Pricing Cards Grid - MASONRY STYLE -->
    <div class="masonry-grid">
    {{ range $block.content.items }}
      <div class="pricing-card flex flex-col rounded-2xl shadow-lg
                  divide-y divide-gray-200 dark:divide-gray-700
                  {{ if .featured }}border-2 border-primary-600 dark:border-primary-400 bg-gradient-to-br from-primary-50 to-white dark:from-primary-900/20 dark:to-gray-800{{ else }}border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800{{ end }}">
        
        <!-- Plan Header - Centered Content -->
        <div class="p-6 sm:px-8 flex flex-col items-center text-center">
          {{ with .icon }}
          <div class="mb-4 text-primary-600 dark:text-primary-300" style="width:128px; height:128px;">
            {{ partial "functions/get_icon" (dict "name" . "attributes" `class="w-32 h-32"`)  }}
          </div>
          {{ end }}

          <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">{{ .name | $page.RenderString }}</h2>
          {{ with .description }}
          <p class="text-xl text-gray-700 dark:text-gray-300 mb-4 max-w-xs">{{ . | $page.RenderString }}</p>
          {{ end }}

          <p class="flex items-baseline gap-1 text-5xl font-extrabold text-gray-900 dark:text-white">
            <span>{{ .price }}</span>
            {{ with .period }}
            <span class="text-2xl font-normal text-gray-900 dark:text-white">{{ . }}</span>
            {{ end }}
          </p>
        </div>

        <!-- Features Section -->
        {{ with .features }}
        <div class="p-6 sm:px-8 flex-1">
          <p class="text-lg font-medium text-gray-900 dark:text-white sm:text-xl mb-4">What's included:</p>

          <ul class="space-y-3 sm:mt-0 text-lg">
            {{ range . }}
            <li class="flex items-center gap-3">
              {{ if .included }}
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6 text-green-600 dark:text-green-400 shadow-sm flex-shrink-0"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
              </svg>
              {{ else }}
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6 text-red-500 dark:text-red-400 shadow-sm flex-shrink-0"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
              {{ end }}

              <span class="text-gray-700 dark:text-gray-300">{{ .text | $page.RenderString }}</span>
            </li>
            {{ end }}
          </ul>
        </div>
        {{ end }}

        <!-- Button at Bottom -->
        {{ with .button }}
        <div class="p-6 sm:px-8 mt-auto">
          <a
            class="block w-full rounded-lg px-12 py-3 text-center text-xl border border-primary-700 font-medium text-primary-700 hover:bg-gradient-to-l focus:ring-4 focus:ring-primary-300 dark:focus:ring-primary-800 focus:outline-none transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1"
            href="{{ .url }}"
            {{ if .target }}target="{{ .target }}"{{ end }}
          >
            {{ .text }}
          </a>
        </div>
        {{ end }}
      </div>
      {{ end }}
    </div>

    <!-- Global CTA Button - SOURCED FROM YOUR CODE -->
    {{ with $block.content.button }}
    <div class="text-center mt-16">
      <a href="{{.url}}" 
         {{ if .target }}target="{{ .target }}"{{ end }}
         class="mt-3 relative inline-flex items-center gap-1 rounded-lg border border-primary-700 bg-white dark:bg-gray-800 px-6 py-2 text-xl font-medium text-primary-700 dark:text-primary-300 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-700 focus:ring-offset-2 dark:focus:ring-offset-gray-900 transition-colors duration-200">
        {{.text}}
      </a>
    </div>
    {{ end }}
  </div>
</section>
