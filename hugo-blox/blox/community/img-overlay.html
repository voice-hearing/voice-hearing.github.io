{{/* Hugo Blox: Features */}}
{{/* Documentation: https://hugoblox.com/blocks/ */}}
{{/* License: https://github.com/HugoBlox/hugo-blox-builder/blob/main/LICENSE.md */}}

{{/* Initialise */}}
{{ $page := .wcPage }}
{{ $block := .wcBlock }}
{{ $title := $block.content.title | emojify | $page.RenderString }}
{{ $text := $block.content.text | emojify | $page.RenderString }}
{{ $blue := $block.content.blue | emojify | $page.RenderString }}

<section>
  <div class="mx-auto max-w-7xl mt-0 px-8 mb-4">
    
 <div class="flex flex-col">
  {{ with $blue }}
  <p class="mb-2 text-lg md:text-xl tracking-tight uppercase font-semibold text-primary-600 dark:text-primary-300">{{.}}</p>
  {{ end }}
  
  <!-- Red horizontal line above title -->
  <div class="w-16 border-2 border-primary-500 mb-4"></div>
      
  {{ with $title }}
  <h2 class="mb-4 text-xl md:text-4xl lg:text-2xl text-gray-900 dark:text-white">{{.}}</h2>
  {{ end }}
  {{ with $text }}
  <p class="text-xl md:text-2xl text-gray-500 dark:text-gray-400">{{.}}</p>
  {{ end }}
</div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
    
    {{ range $index, $item := $block.content.slides }}
    
    <div class="relative rounded-lg overflow-hidden group shadow-xl">
      
      <!-- Background Image Processing -->
      {{ $bg := $item.background }}
      {{ $bg_img := "" }}
      
      {{ if $bg.image.filename }}
        {{ $bg_img = resources.Get (printf "media/%s" $bg.image.filename) }}
        {{ if $bg_img }}
          {{ $bg_img = $bg_img.Fit "600x600 q70 webp" }}
        {{ end }}
      {{ end }}
      
      <!-- Image Container with 25% Dark Filter -->
      {{ if $bg_img }}
      <img src="{{ $bg_img.RelPermalink }}" 
           alt="{{ $item.title | plainify }}" 
           class="w-full h-96 object-cover transition-all filter brightness-100">
      {{ else }}
      <div class="w-full h-96 bg-gray-400 filter brightness-100"></div>
      {{ end }}
      
      
      <!-- Gradient Overlay -->
       <a href="{{.url}}">
      <div class="absolute inset-0"></div>
      </a>
      <!-- Dynamic Text Positioning with All Text Centered -->
      <div class="absolute left-0 right-0 px-6 text-white text-center
        {{ if eq $item.align "top" }}top-0 pt-6{{ $item.align | default "" }}
        {{ else if eq $item.align "bottom" }}bottom-0 pb-6{{ $item.align | default "" }}
        {{ else if eq $item.align "center" }}top-1/2 transform -translate-y-1/2
        {{ else }}bottom-0 pb-6{{ end }}"
        style="{{ if eq $item.align "top" }}top: 5%;{{ else if eq $item.align "bottom" }}bottom: 5%;{{ end }}">
        
        <div class="space-y-3">
            <a href="{{.url}}">
          {{ with $item.title }}
          <h2 class="text-3xl" style="text-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);">
            {{ . | markdownify | emojify }} 
          </h2>
          {{ end }}
          </a>
          
          {{ with $item.content }}
          <div class="text-sm md:text-base drop-shadow-lg max-w-sm mx-auto">
            {{ . | emojify | $page.RenderString }}
          </div>
          {{ end }}
        </div>
      </div>
      
    </div>
    
    {{ end }}
    
  </div>
</div>
