{{/* Hugo Blox: Hero with Left-Aligned Title and Tight Black Background */}}
{{/* Documentation: https://hugoblox.com/blocks/ */}}
{{/* License: https://github.com/HugoBlox/hugo-blox-builder/blob/main/LICENSE.md */}}

{{/* Initialise */}}
{{ $page := .wcPage }}
{{ $block := .wcBlock }}

<style>
    .overlay-bg-light {
      background-color: rgba(255, 255, 255, 0.9);
    }
    .overlay-bg-dark {
      background-color: rgba(0, 0, 0, 0.7);
    }
  </style>

<div class="relative isolate max-w-screen-xl mx-auto" style="min-height: 80vh;">

  <!-- Background Image Constrained to Container -->
  {{ $bg := $block.content.background }}
  {{ $bg_img := "" }}
  {{ if $bg.image.filename }}
    {{ $bg_img = resources.Get (printf "media/%s" $bg.image.filename) }}
    {{ if $bg_img }}
      {{ $bg_img = $bg_img.Fit "1920x1080 q80 webp" }}
    {{ end }}
  {{ end }}

  {{ if $bg_img }}
  <div class="absolute inset-0 overflow-hidden rounded-xl">
    <img src="{{ $bg_img.RelPermalink }}" 
         alt="Hero background" 
         width="{{ $bg_img.Width }}"
         height="{{ $bg_img.Height }}"
         class="w-full h-full object-cover object-center rounded-xl" />
    <div class="absolute inset-0 bg-black/40 rounded-xl"></div>
  </div>
  {{ end }}

  <!-- Content in same constrained container -->
  <div class="relative z-10 py-12 lg:py-16 px-4 md:px-7">

    {{ if $block.content.announcement.text }}
    {{ $announcement := $block.content.announcement }}
    <div class="hidden sm:mb-8 sm:flex">
      <div class="relative rounded-lg px-3 py-1 text-lg leading-6 text-gray-900 dark:text-gray-100 border border-gray-300 bg-white/90 dark:border-gray-500 dark:bg-gray-800/90 backdrop-blur-sm">
        {{$announcement.text | markdownify}} 
        {{ if $announcement.link.text }}
          <a href="{{$announcement.link.url}}" class="font-semibold text-primary-600 dark:text-primary-300">
            <span class="absolute inset-0" aria-hidden="true"></span>{{$announcement.link.text}} <span aria-hidden="true">&rarr;</span>
          </a>
        {{ end }}
      </div>
    </div>
    {{end}}

    <!-- Hero Title - Left Aligned with Tight Black Background -->
    {{ with $block.content.title }}
    <div class="mb-12 max-w-xl xl:max-w-7xl flex justify-start">
      <div class="overlay-bg-light dark:overlay-bg-dark rounded-2xl shadow-2xl inline-block px-6 py-3">
        <h1 class="text-4xl md:text-5xl lg:text-5xl text-gray-900 dark:font-medium font-bold leading-tight">
          {{ . | markdownify }}
        </h1>
      </div>
    </div>
    {{ end }}

    <!-- Optional Action Buttons -->
    <div class="flex flex-col sm:flex-row gap-6 mb-16">
      {{ if $block.content.primary_action.url }}
      <div>
        {{ $link := $block.content.primary_action.url }}
        {{ $scheme := (urls.Parse $link).Scheme }}
        {{ $target := "" }}
        {{ if not $scheme }}
          {{ $link = $link | relLangURL }}
        {{ else if in (slice "http" "https") $scheme }}
          {{ $target = "target=\"_blank\" rel=\"noopener\"" }}
        {{ end }}
        <a href="{{ $link | safeURL }}" {{ $target | safeHTMLAttr }} 
           class="inline-flex justify-center items-center rounded-lg bg-primary-700 px-8 py-4 md:px-10 md:py-5 text-xl font-bold shadow-lg hover:bg-primary-500 hover:shadow-xl transition-all duration-300"
           style="color: white !important; text-decoration: none !important;">
          {{ $block.content.primary_action.text | markdownify | emojify }}
          {{ with $block.content.primary_action.icon }}
            {{ partial "functions/get_icon" (dict "name" . "attributes" "style=\"height: 1em\" class='inline-block ml-3'") }}
          {{ end }}
        </a>
      </div>
      {{end}}
      
      {{ if $block.content.secondary_action.url }}
      <div>
        {{ $link_alt := $block.content.secondary_action.url }}
        {{ $scheme_alt := (urls.Parse $link_alt).Scheme }}
        {{ $target_alt := "" }}
        {{ if not $scheme_alt }}
          {{ $link_alt = $link_alt | relLangURL }}
        {{ else if in (slice "http" "https") $scheme_alt }}
          {{ $target_alt = "target=\"_blank\" rel=\"noopener\"" }}
        {{ end }}
        <a href="{{ $link_alt | safeURL }}" {{ $target_alt | safeHTMLAttr }} 
           class="inline-flex justify-center items-center rounded-lg border-2 border-white/80 bg-white/90 px-8 py-4 md:px-10 md:py-5 text-lg md:text-xl font-bold text-gray-900 hover:text-primary-600 hover:border-primary-600 transition-all duration-300 shadow-lg hover:shadow-xl backdrop-blur-sm">
          {{ $block.content.secondary_action.text | markdownify | emojify }} 
          <span class="ml-2 text-xl" aria-hidden="true">â†’</span>
        </a>
      </div>
      {{end}}
    </div>

    <!-- Supporting text with improved hierarchy -->
    <div class="max-w-2xl space-y-6">
      {{ with $block.content.text }}
      <div class="bg-primary-600/90 px-6 py-4 rounded-xl backdrop-blur-sm">
        <p class="text-xl md:text-2xl font-bold text-white leading-tight">
          {{ . | $page.RenderString | emojify }}
        </p>
      </div>
      {{end}}
      
      {{ with $block.content.secondary }}
      <div class="bg-white/10 px-6 py-4 rounded-lg backdrop-blur-sm">
        <p class="text-lg md:text-xl text-white leading-relaxed">
          {{ . | $page.RenderString | emojify }}
        </p>
      </div>
      {{end}}
    </div>

  </div>
</div>
