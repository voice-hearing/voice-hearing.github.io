import _styled from "@emotion/styled/base";
function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }
function _EMOTION_STRINGIFIED_CSS_ERROR__() { return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."; }
// @refresh reset
import React, { useCallback, useEffect, useMemo, useState } from 'react';
import PropTypes from 'prop-types';
import ImmutablePropTypes from 'react-immutable-proptypes';
import { ClassNames, css as coreCss } from '@emotion/react';
import { lengths, fonts, zIndex } from 'decap-cms-ui-default';
import { createEditor, Transforms, Editor as SlateEditor } from 'slate';
import { Editable, ReactEditor, Slate, withReact } from 'slate-react';
import { withHistory } from 'slate-history';
import { fromJS } from 'immutable';
import isEqual from 'lodash/isEqual';
import { editorStyleVars, EditorControlBar } from '../styles';
import Toolbar from './Toolbar';
import { Element, Leaf } from './renderers';
import withLists from './plugins/lists/withLists';
import withBlocks from './plugins/blocks/withBlocks';
import withInlines from './plugins/inlines/withInlines';
import toggleMark from './plugins/inlines/events/toggleMark';
import toggleLink from './plugins/inlines/events/toggleLink';
import getActiveLink from './plugins/inlines/selectors/getActiveLink';
import isMarkActive from './plugins/inlines/locations/isMarkActive';
import isCursorInBlockType from './plugins/blocks/locations/isCursorInBlockType';
import { markdownToSlate, slateToMarkdown } from '../serializers';
import withShortcodes from './plugins/shortcodes/withShortcodes';
import insertShortcode from './plugins/shortcodes/insertShortcode';
import defaultEmptyBlock from './plugins/blocks/defaultEmptyBlock';
import withHtml from './plugins/html/withHtml';
import { jsx as ___EmotionJSX } from "@emotion/react";
function visualEditorStyles({
  minimal
}) {
  return `
  position: relative;
  overflow: auto;
  font-family: ${fonts.primary};
  min-height: ${minimal ? 'auto' : lengths.richTextEditorMinHeight};
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  border-top: 0;
  margin-top: -${editorStyleVars.stickyDistanceBottom};
  padding: 0;
  display: flex;
  flex-direction: column;
  z-index: ${zIndex.zIndex100};
`;
}
const InsertionPoint = /*#__PURE__*/_styled("div", {
  target: "ebiot7z0",
  label: "InsertionPoint"
})(process.env.NODE_ENV === "production" ? {
  name: "ma7xbc",
  styles: "flex:1 1 auto;cursor:text"
} : {
  name: "ma7xbc",
  styles: "flex:1 1 auto;cursor:text/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9NYXJrZG93bkNvbnRyb2wvVmlzdWFsRWRpdG9yLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQStDaUMiLCJmaWxlIjoiLi4vLi4vLi4vc3JjL01hcmtkb3duQ29udHJvbC9WaXN1YWxFZGl0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAcmVmcmVzaCByZXNldFxuaW1wb3J0IFJlYWN0LCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZU1lbW8sIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBJbW11dGFibGVQcm9wVHlwZXMgZnJvbSAncmVhY3QtaW1tdXRhYmxlLXByb3B0eXBlcyc7XG5pbXBvcnQgeyBDbGFzc05hbWVzLCBjc3MgYXMgY29yZUNzcyB9IGZyb20gJ0BlbW90aW9uL3JlYWN0JztcbmltcG9ydCB7IGxlbmd0aHMsIGZvbnRzLCB6SW5kZXggfSBmcm9tICdkZWNhcC1jbXMtdWktZGVmYXVsdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCc7XG5pbXBvcnQgeyBjcmVhdGVFZGl0b3IsIFRyYW5zZm9ybXMsIEVkaXRvciBhcyBTbGF0ZUVkaXRvciB9IGZyb20gJ3NsYXRlJztcbmltcG9ydCB7IEVkaXRhYmxlLCBSZWFjdEVkaXRvciwgU2xhdGUsIHdpdGhSZWFjdCB9IGZyb20gJ3NsYXRlLXJlYWN0JztcbmltcG9ydCB7IHdpdGhIaXN0b3J5IH0gZnJvbSAnc2xhdGUtaGlzdG9yeSc7XG5pbXBvcnQgeyBmcm9tSlMgfSBmcm9tICdpbW11dGFibGUnO1xuaW1wb3J0IGlzRXF1YWwgZnJvbSAnbG9kYXNoL2lzRXF1YWwnO1xuXG5pbXBvcnQgeyBlZGl0b3JTdHlsZVZhcnMsIEVkaXRvckNvbnRyb2xCYXIgfSBmcm9tICcuLi9zdHlsZXMnO1xuaW1wb3J0IFRvb2xiYXIgZnJvbSAnLi9Ub29sYmFyJztcbmltcG9ydCB7IEVsZW1lbnQsIExlYWYgfSBmcm9tICcuL3JlbmRlcmVycyc7XG5pbXBvcnQgd2l0aExpc3RzIGZyb20gJy4vcGx1Z2lucy9saXN0cy93aXRoTGlzdHMnO1xuaW1wb3J0IHdpdGhCbG9ja3MgZnJvbSAnLi9wbHVnaW5zL2Jsb2Nrcy93aXRoQmxvY2tzJztcbmltcG9ydCB3aXRoSW5saW5lcyBmcm9tICcuL3BsdWdpbnMvaW5saW5lcy93aXRoSW5saW5lcyc7XG5pbXBvcnQgdG9nZ2xlTWFyayBmcm9tICcuL3BsdWdpbnMvaW5saW5lcy9ldmVudHMvdG9nZ2xlTWFyayc7XG5pbXBvcnQgdG9nZ2xlTGluayBmcm9tICcuL3BsdWdpbnMvaW5saW5lcy9ldmVudHMvdG9nZ2xlTGluayc7XG5pbXBvcnQgZ2V0QWN0aXZlTGluayBmcm9tICcuL3BsdWdpbnMvaW5saW5lcy9zZWxlY3RvcnMvZ2V0QWN0aXZlTGluayc7XG5pbXBvcnQgaXNNYXJrQWN0aXZlIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL2xvY2F0aW9ucy9pc01hcmtBY3RpdmUnO1xuaW1wb3J0IGlzQ3Vyc29ySW5CbG9ja1R5cGUgZnJvbSAnLi9wbHVnaW5zL2Jsb2Nrcy9sb2NhdGlvbnMvaXNDdXJzb3JJbkJsb2NrVHlwZSc7XG5pbXBvcnQgeyBtYXJrZG93blRvU2xhdGUsIHNsYXRlVG9NYXJrZG93biB9IGZyb20gJy4uL3NlcmlhbGl6ZXJzJztcbmltcG9ydCB3aXRoU2hvcnRjb2RlcyBmcm9tICcuL3BsdWdpbnMvc2hvcnRjb2Rlcy93aXRoU2hvcnRjb2Rlcyc7XG5pbXBvcnQgaW5zZXJ0U2hvcnRjb2RlIGZyb20gJy4vcGx1Z2lucy9zaG9ydGNvZGVzL2luc2VydFNob3J0Y29kZSc7XG5pbXBvcnQgZGVmYXVsdEVtcHR5QmxvY2sgZnJvbSAnLi9wbHVnaW5zL2Jsb2Nrcy9kZWZhdWx0RW1wdHlCbG9jayc7XG5pbXBvcnQgd2l0aEh0bWwgZnJvbSAnLi9wbHVnaW5zL2h0bWwvd2l0aEh0bWwnO1xuXG5mdW5jdGlvbiB2aXN1YWxFZGl0b3JTdHlsZXMoeyBtaW5pbWFsIH0pIHtcbiAgcmV0dXJuIGBcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBvdmVyZmxvdzogYXV0bztcbiAgZm9udC1mYW1pbHk6ICR7Zm9udHMucHJpbWFyeX07XG4gIG1pbi1oZWlnaHQ6ICR7bWluaW1hbCA/ICdhdXRvJyA6IGxlbmd0aHMucmljaFRleHRFZGl0b3JNaW5IZWlnaHR9O1xuICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiAwO1xuICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogMDtcbiAgYm9yZGVyLXRvcDogMDtcbiAgbWFyZ2luLXRvcDogLSR7ZWRpdG9yU3R5bGVWYXJzLnN0aWNreURpc3RhbmNlQm90dG9tfTtcbiAgcGFkZGluZzogMDtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgei1pbmRleDogJHt6SW5kZXguekluZGV4MTAwfTtcbmA7XG59XG5cbmNvbnN0IEluc2VydGlvblBvaW50ID0gc3R5bGVkLmRpdmBcbiAgZmxleDogMSAxIGF1dG87XG4gIGN1cnNvcjogdGV4dDtcbmA7XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZU1lZGlhQ29uZmlnKGVkaXRvckNvbXBvbmVudHMsIGZpZWxkKSB7XG4gIC8vIG1lcmdlIGVkaXRvciBtZWRpYSBsaWJyYXJ5IGNvbmZpZyB0byBpbWFnZSBjb21wb25lbnRzXG4gIGlmIChlZGl0b3JDb21wb25lbnRzLmhhcygnaW1hZ2UnKSkge1xuICAgIGNvbnN0IGltYWdlQ29tcG9uZW50ID0gZWRpdG9yQ29tcG9uZW50cy5nZXQoJ2ltYWdlJyk7XG4gICAgY29uc3QgZmllbGRzID0gaW1hZ2VDb21wb25lbnQ/LmZpZWxkcztcblxuICAgIGlmIChmaWVsZHMpIHtcbiAgICAgIGltYWdlQ29tcG9uZW50LmZpZWxkcyA9IGZpZWxkcy51cGRhdGUoXG4gICAgICAgIGZpZWxkcy5maW5kSW5kZXgoZiA9PiBmLmdldCgnd2lkZ2V0JykgPT09ICdpbWFnZScpLFxuICAgICAgICBmID0+IHtcbiAgICAgICAgICAvLyBtZXJnZSBgbWVkaWFfbGlicmFyeWAgY29uZmlnXG4gICAgICAgICAgaWYgKGZpZWxkLmhhcygnbWVkaWFfbGlicmFyeScpKSB7XG4gICAgICAgICAgICBmID0gZi5zZXQoXG4gICAgICAgICAgICAgICdtZWRpYV9saWJyYXJ5JyxcbiAgICAgICAgICAgICAgZmllbGQuZ2V0KCdtZWRpYV9saWJyYXJ5JykubWVyZ2VEZWVwKGYuZ2V0KCdtZWRpYV9saWJyYXJ5JykpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gbWVyZ2UgJ21lZGlhX2ZvbGRlcidcbiAgICAgICAgICBpZiAoZmllbGQuaGFzKCdtZWRpYV9mb2xkZXInKSAmJiAhZi5oYXMoJ21lZGlhX2ZvbGRlcicpKSB7XG4gICAgICAgICAgICBmID0gZi5zZXQoJ21lZGlhX2ZvbGRlcicsIGZpZWxkLmdldCgnbWVkaWFfZm9sZGVyJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBtZXJnZSAncHVibGljX2ZvbGRlcidcbiAgICAgICAgICBpZiAoZmllbGQuaGFzKCdwdWJsaWNfZm9sZGVyJykgJiYgIWYuaGFzKCdwdWJsaWNfZm9sZGVyJykpIHtcbiAgICAgICAgICAgIGYgPSBmLnNldCgncHVibGljX2ZvbGRlcicsIGZpZWxkLmdldCgncHVibGljX2ZvbGRlcicpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGY7XG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBFZGl0b3IocHJvcHMpIHtcbiAgY29uc3Qge1xuICAgIG9uQWRkQXNzZXQsXG4gICAgZ2V0QXNzZXQsXG4gICAgY2xhc3NOYW1lLFxuICAgIGZpZWxkLFxuICAgIGlzU2hvd01vZGVUb2dnbGUsXG4gICAgdCxcbiAgICBpc0Rpc2FibGVkLFxuICAgIGdldEVkaXRvckNvbXBvbmVudHMsXG4gICAgZ2V0UmVtYXJrUGx1Z2lucyxcbiAgICBvbkNoYW5nZSxcbiAgfSA9IHByb3BzO1xuXG4gIGNvbnN0IGVkaXRvciA9IHVzZU1lbW8oXG4gICAgKCkgPT5cbiAgICAgIHdpdGhIdG1sKFxuICAgICAgICB3aXRoUmVhY3Qod2l0aEhpc3Rvcnkod2l0aFNob3J0Y29kZXMod2l0aEJsb2Nrcyh3aXRoTGlzdHMod2l0aElubGluZXMoY3JlYXRlRWRpdG9yKCkpKSkpKSksXG4gICAgICApLFxuICAgIFtdLFxuICApO1xuXG4gIGNvbnN0IGVtcHR5VmFsdWUgPSBbZGVmYXVsdEVtcHR5QmxvY2soKV07XG4gIGxldCBlZGl0b3JDb21wb25lbnRzID0gZ2V0RWRpdG9yQ29tcG9uZW50cygpO1xuICBjb25zdCBjb2RlQmxvY2tDb21wb25lbnQgPSBmcm9tSlMoZWRpdG9yQ29tcG9uZW50cy5maW5kKCh7IHR5cGUgfSkgPT4gdHlwZSA9PT0gJ2NvZGUtYmxvY2snKSk7XG5cbiAgZWRpdG9yQ29tcG9uZW50cyA9XG4gICAgY29kZUJsb2NrQ29tcG9uZW50IHx8IGVkaXRvckNvbXBvbmVudHMuaGFzKCdjb2RlLWJsb2NrJylcbiAgICAgID8gZWRpdG9yQ29tcG9uZW50c1xuICAgICAgOiBlZGl0b3JDb21wb25lbnRzLnNldCgnY29kZS1ibG9jaycsIHsgbGFiZWw6ICdDb2RlIEJsb2NrJywgdHlwZTogJ2NvZGUtYmxvY2snIH0pO1xuXG4gIG1lcmdlTWVkaWFDb25maWcoZWRpdG9yQ29tcG9uZW50cywgZmllbGQpO1xuXG4gIGNvbnN0IFtlZGl0b3JWYWx1ZSwgc2V0RWRpdG9yVmFsdWVdID0gdXNlU3RhdGUoXG4gICAgcHJvcHMudmFsdWVcbiAgICAgID8gbWFya2Rvd25Ub1NsYXRlKHByb3BzLnZhbHVlLCB7XG4gICAgICAgICAgdm9pZENvZGVCbG9jazogISFjb2RlQmxvY2tDb21wb25lbnQsXG4gICAgICAgICAgcmVtYXJrUGx1Z2luczogZ2V0UmVtYXJrUGx1Z2lucygpLFxuICAgICAgICB9KVxuICAgICAgOiBlbXB0eVZhbHVlLFxuICApO1xuXG4gIGNvbnN0IHJlbmRlckVsZW1lbnQgPSB1c2VDYWxsYmFjayhcbiAgICBwcm9wcyA9PiAoXG4gICAgICA8RWxlbWVudCB7Li4ucHJvcHN9IGNsYXNzTmFtZVdyYXBwZXI9e2NsYXNzTmFtZX0gY29kZUJsb2NrQ29tcG9uZW50PXtjb2RlQmxvY2tDb21wb25lbnR9IC8+XG4gICAgKSxcbiAgICBbXSxcbiAgKTtcbiAgY29uc3QgcmVuZGVyTGVhZiA9IHVzZUNhbGxiYWNrKHByb3BzID0+IDxMZWFmIHsuLi5wcm9wc30gLz4sIFtdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChwcm9wcy5wZW5kaW5nRm9jdXMpIHtcbiAgICAgIFJlYWN0RWRpdG9yLmZvY3VzKGVkaXRvcik7XG4gICAgICBwcm9wcy5wZW5kaW5nRm9jdXMoKTtcbiAgICB9XG4gIH0sIFtwcm9wcy5wZW5kaW5nRm9jdXNdKTtcblxuICBmdW5jdGlvbiBoYW5kbGVNYXJrQ2xpY2soZm9ybWF0KSB7XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgICB0b2dnbGVNYXJrKGVkaXRvciwgZm9ybWF0KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUJsb2NrQ2xpY2soZm9ybWF0KSB7XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgICBpZiAoZm9ybWF0LmVuZHNXaXRoKCctbGlzdCcpKSB7XG4gICAgICBlZGl0b3IudG9nZ2xlTGlzdChmb3JtYXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlZGl0b3IudG9nZ2xlQmxvY2soZm9ybWF0KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVMaW5rQ2xpY2soKSB7XG4gICAgdG9nZ2xlTGluayhlZGl0b3IsIHQoJ2VkaXRvci5lZGl0b3JXaWRnZXRzLm1hcmtkb3duLmxpbmtQcm9tcHQnKSk7XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVRvZ2dsZU1vZGUoKSB7XG4gICAgcHJvcHMub25Nb2RlKCdyYXcnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUluc2VydFNob3J0Y29kZShwbHVnaW5Db25maWcpIHtcbiAgICBpbnNlcnRTaG9ydGNvZGUoZWRpdG9yLCBwbHVnaW5Db25maWcpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlS2V5RG93bihldmVudCkge1xuICAgIGZvciAoY29uc3QgaGFuZGxlciBvZiBlZGl0b3Iua2V5RG93bkhhbmRsZXJzIHx8IFtdKSB7XG4gICAgICBpZiAoaGFuZGxlcihldmVudCwgZWRpdG9yKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIFJlYWN0RWRpdG9yLmZvY3VzKGVkaXRvcik7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVDbGlja0JlbG93RG9jdW1lbnQoKSB7XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgICBUcmFuc2Zvcm1zLnNlbGVjdChlZGl0b3IsIHsgcGF0aDogWzAsIDBdLCBvZmZzZXQ6IDAgfSk7XG4gICAgVHJhbnNmb3Jtcy5zZWxlY3QoZWRpdG9yLCBTbGF0ZUVkaXRvci5lbmQoZWRpdG9yLCBbXSkpO1xuICB9XG4gIGNvbnN0IFt0b29sYmFyS2V5LCBzZXRUb29sYmFyS2V5XSA9IHVzZVN0YXRlKDApO1xuXG4gIGZ1bmN0aW9uIGhhbmRsZUNoYW5nZShuZXdWYWx1ZSkge1xuICAgIGlmICghaXNFcXVhbChuZXdWYWx1ZSwgZWRpdG9yVmFsdWUpKSB7XG4gICAgICBzZXRFZGl0b3JWYWx1ZSgoKSA9PiBuZXdWYWx1ZSk7XG4gICAgICBvbkNoYW5nZShcbiAgICAgICAgc2xhdGVUb01hcmtkb3duKG5ld1ZhbHVlLCB7XG4gICAgICAgICAgdm9pZENvZGVCbG9jazogISFjb2RlQmxvY2tDb21wb25lbnQsXG4gICAgICAgICAgcmVtYXJrUGx1Z2luczogZ2V0UmVtYXJrUGx1Z2lucygpLFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgfVxuICAgIHNldFRvb2xiYXJLZXkocHJldiA9PiBwcmV2ICsgMSk7XG4gIH1cblxuICBmdW5jdGlvbiBoYXNNYXJrKGZvcm1hdCkge1xuICAgIHJldHVybiBpc01hcmtBY3RpdmUoZWRpdG9yLCBmb3JtYXQpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFzSW5saW5lKGZvcm1hdCkge1xuICAgIGlmIChmb3JtYXQgPT0gJ2xpbmsnKSB7XG4gICAgICByZXR1cm4gISFnZXRBY3RpdmVMaW5rKGVkaXRvcik7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhc0Jsb2NrKGZvcm1hdCkge1xuICAgIHJldHVybiBpc0N1cnNvckluQmxvY2tUeXBlKGVkaXRvciwgZm9ybWF0KTtcbiAgfVxuICBmdW5jdGlvbiBoYXNRdW90ZSgpIHtcbiAgICByZXR1cm4gaXNDdXJzb3JJbkJsb2NrVHlwZShlZGl0b3IsICdxdW90ZScpO1xuICB9XG4gIGZ1bmN0aW9uIGhhc0xpc3RJdGVtcyh0eXBlKSB7XG4gICAgcmV0dXJuIGlzQ3Vyc29ySW5CbG9ja1R5cGUoZWRpdG9yLCB0eXBlKTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY3NzPXtjb3JlQ3NzYFxuICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICBgfVxuICAgID5cbiAgICAgIDxTbGF0ZSBlZGl0b3I9e2VkaXRvcn0gdmFsdWU9e2VkaXRvclZhbHVlfSBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfT5cbiAgICAgICAgPEVkaXRvckNvbnRyb2xCYXI+XG4gICAgICAgICAge1xuICAgICAgICAgICAgPFRvb2xiYXJcbiAgICAgICAgICAgICAga2V5PXt0b29sYmFyS2V5fVxuICAgICAgICAgICAgICBvbk1hcmtDbGljaz17aGFuZGxlTWFya0NsaWNrfVxuICAgICAgICAgICAgICBvbkJsb2NrQ2xpY2s9e2hhbmRsZUJsb2NrQ2xpY2t9XG4gICAgICAgICAgICAgIG9uTGlua0NsaWNrPXtoYW5kbGVMaW5rQ2xpY2t9XG4gICAgICAgICAgICAgIG9uVG9nZ2xlTW9kZT17aGFuZGxlVG9nZ2xlTW9kZX1cbiAgICAgICAgICAgICAgcGx1Z2lucz17ZWRpdG9yQ29tcG9uZW50c31cbiAgICAgICAgICAgICAgb25TdWJtaXQ9e2hhbmRsZUluc2VydFNob3J0Y29kZX1cbiAgICAgICAgICAgICAgb25BZGRBc3NldD17b25BZGRBc3NldH1cbiAgICAgICAgICAgICAgZ2V0QXNzZXQ9e2dldEFzc2V0fVxuICAgICAgICAgICAgICBidXR0b25zPXtmaWVsZC5nZXQoJ2J1dHRvbnMnKX1cbiAgICAgICAgICAgICAgZWRpdG9yQ29tcG9uZW50cz17ZmllbGQuZ2V0KCdlZGl0b3JfY29tcG9uZW50cycpfVxuICAgICAgICAgICAgICBoYXNNYXJrPXtoYXNNYXJrfVxuICAgICAgICAgICAgICBoYXNJbmxpbmU9e2hhc0lubGluZX1cbiAgICAgICAgICAgICAgaGFzQmxvY2s9e2hhc0Jsb2NrfVxuICAgICAgICAgICAgICBoYXNRdW90ZT17aGFzUXVvdGV9XG4gICAgICAgICAgICAgIGhhc0xpc3RJdGVtcz17aGFzTGlzdEl0ZW1zfVxuICAgICAgICAgICAgICBpc1Nob3dNb2RlVG9nZ2xlPXtpc1Nob3dNb2RlVG9nZ2xlfVxuICAgICAgICAgICAgICB0PXt0fVxuICAgICAgICAgICAgICBkaXNhYmxlZD17aXNEaXNhYmxlZH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgfVxuICAgICAgICA8L0VkaXRvckNvbnRyb2xCYXI+XG4gICAgICAgIHtcbiAgICAgICAgICA8Q2xhc3NOYW1lcz5cbiAgICAgICAgICAgIHsoeyBjc3MsIGN4IH0pID0+IChcbiAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y3goXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgICAgICAgICAgICBjc3NgXG4gICAgICAgICAgICAgICAgICAgICR7dmlzdWFsRWRpdG9yU3R5bGVzKHsgbWluaW1hbDogZmllbGQuZ2V0KCdtaW5pbWFsJykgfSl9XG4gICAgICAgICAgICAgICAgICBgLFxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7ZWRpdG9yVmFsdWUubGVuZ3RoICE9PSAwICYmIChcbiAgICAgICAgICAgICAgICAgIDxFZGl0YWJsZVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2Nzc2BcbiAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxNnB4IDIwcHggMDtcbiAgICAgICAgICAgICAgICAgICAgYH1cbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyRWxlbWVudD17cmVuZGVyRWxlbWVudH1cbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyTGVhZj17cmVuZGVyTGVhZn1cbiAgICAgICAgICAgICAgICAgICAgb25LZXlEb3duPXtoYW5kbGVLZXlEb3dufVxuICAgICAgICAgICAgICAgICAgICBhdXRvRm9jdXM9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDxJbnNlcnRpb25Qb2ludCBvbkNsaWNrPXtoYW5kbGVDbGlja0JlbG93RG9jdW1lbnR9IC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L0NsYXNzTmFtZXM+XG4gICAgICAgIH1cbiAgICAgIDwvU2xhdGU+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cbkVkaXRvci5wcm9wVHlwZXMgPSB7XG4gIG9uQWRkQXNzZXQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGdldEFzc2V0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25Nb2RlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgdmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGZpZWxkOiBJbW11dGFibGVQcm9wVHlwZXMubWFwLmlzUmVxdWlyZWQsXG4gIGdldEVkaXRvckNvbXBvbmVudHM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGdldFJlbWFya1BsdWdpbnM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGlzU2hvd01vZGVUb2dnbGU6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gIHQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBFZGl0b3I7XG4iXX0= */",
  toString: _EMOTION_STRINGIFIED_CSS_ERROR__
});
export function mergeMediaConfig(editorComponents, field) {
  // merge editor media library config to image components
  if (editorComponents.has('image')) {
    const imageComponent = editorComponents.get('image');
    const fields = imageComponent?.fields;
    if (fields) {
      imageComponent.fields = fields.update(fields.findIndex(f => f.get('widget') === 'image'), f => {
        // merge `media_library` config
        if (field.has('media_library')) {
          f = f.set('media_library', field.get('media_library').mergeDeep(f.get('media_library')));
        }
        // merge 'media_folder'
        if (field.has('media_folder') && !f.has('media_folder')) {
          f = f.set('media_folder', field.get('media_folder'));
        }
        // merge 'public_folder'
        if (field.has('public_folder') && !f.has('public_folder')) {
          f = f.set('public_folder', field.get('public_folder'));
        }
        return f;
      });
    }
  }
}
var _ref = process.env.NODE_ENV === "production" ? {
  name: "j8ayvn-Editor",
  styles: "position:relative;label:Editor;"
} : {
  name: "j8ayvn-Editor",
  styles: "position:relative;label:Editor;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9NYXJrZG93bkNvbnRyb2wvVmlzdWFsRWRpdG9yLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQTROa0IiLCJmaWxlIjoiLi4vLi4vLi4vc3JjL01hcmtkb3duQ29udHJvbC9WaXN1YWxFZGl0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAcmVmcmVzaCByZXNldFxuaW1wb3J0IFJlYWN0LCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZU1lbW8sIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBJbW11dGFibGVQcm9wVHlwZXMgZnJvbSAncmVhY3QtaW1tdXRhYmxlLXByb3B0eXBlcyc7XG5pbXBvcnQgeyBDbGFzc05hbWVzLCBjc3MgYXMgY29yZUNzcyB9IGZyb20gJ0BlbW90aW9uL3JlYWN0JztcbmltcG9ydCB7IGxlbmd0aHMsIGZvbnRzLCB6SW5kZXggfSBmcm9tICdkZWNhcC1jbXMtdWktZGVmYXVsdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCc7XG5pbXBvcnQgeyBjcmVhdGVFZGl0b3IsIFRyYW5zZm9ybXMsIEVkaXRvciBhcyBTbGF0ZUVkaXRvciB9IGZyb20gJ3NsYXRlJztcbmltcG9ydCB7IEVkaXRhYmxlLCBSZWFjdEVkaXRvciwgU2xhdGUsIHdpdGhSZWFjdCB9IGZyb20gJ3NsYXRlLXJlYWN0JztcbmltcG9ydCB7IHdpdGhIaXN0b3J5IH0gZnJvbSAnc2xhdGUtaGlzdG9yeSc7XG5pbXBvcnQgeyBmcm9tSlMgfSBmcm9tICdpbW11dGFibGUnO1xuaW1wb3J0IGlzRXF1YWwgZnJvbSAnbG9kYXNoL2lzRXF1YWwnO1xuXG5pbXBvcnQgeyBlZGl0b3JTdHlsZVZhcnMsIEVkaXRvckNvbnRyb2xCYXIgfSBmcm9tICcuLi9zdHlsZXMnO1xuaW1wb3J0IFRvb2xiYXIgZnJvbSAnLi9Ub29sYmFyJztcbmltcG9ydCB7IEVsZW1lbnQsIExlYWYgfSBmcm9tICcuL3JlbmRlcmVycyc7XG5pbXBvcnQgd2l0aExpc3RzIGZyb20gJy4vcGx1Z2lucy9saXN0cy93aXRoTGlzdHMnO1xuaW1wb3J0IHdpdGhCbG9ja3MgZnJvbSAnLi9wbHVnaW5zL2Jsb2Nrcy93aXRoQmxvY2tzJztcbmltcG9ydCB3aXRoSW5saW5lcyBmcm9tICcuL3BsdWdpbnMvaW5saW5lcy93aXRoSW5saW5lcyc7XG5pbXBvcnQgdG9nZ2xlTWFyayBmcm9tICcuL3BsdWdpbnMvaW5saW5lcy9ldmVudHMvdG9nZ2xlTWFyayc7XG5pbXBvcnQgdG9nZ2xlTGluayBmcm9tICcuL3BsdWdpbnMvaW5saW5lcy9ldmVudHMvdG9nZ2xlTGluayc7XG5pbXBvcnQgZ2V0QWN0aXZlTGluayBmcm9tICcuL3BsdWdpbnMvaW5saW5lcy9zZWxlY3RvcnMvZ2V0QWN0aXZlTGluayc7XG5pbXBvcnQgaXNNYXJrQWN0aXZlIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL2xvY2F0aW9ucy9pc01hcmtBY3RpdmUnO1xuaW1wb3J0IGlzQ3Vyc29ySW5CbG9ja1R5cGUgZnJvbSAnLi9wbHVnaW5zL2Jsb2Nrcy9sb2NhdGlvbnMvaXNDdXJzb3JJbkJsb2NrVHlwZSc7XG5pbXBvcnQgeyBtYXJrZG93blRvU2xhdGUsIHNsYXRlVG9NYXJrZG93biB9IGZyb20gJy4uL3NlcmlhbGl6ZXJzJztcbmltcG9ydCB3aXRoU2hvcnRjb2RlcyBmcm9tICcuL3BsdWdpbnMvc2hvcnRjb2Rlcy93aXRoU2hvcnRjb2Rlcyc7XG5pbXBvcnQgaW5zZXJ0U2hvcnRjb2RlIGZyb20gJy4vcGx1Z2lucy9zaG9ydGNvZGVzL2luc2VydFNob3J0Y29kZSc7XG5pbXBvcnQgZGVmYXVsdEVtcHR5QmxvY2sgZnJvbSAnLi9wbHVnaW5zL2Jsb2Nrcy9kZWZhdWx0RW1wdHlCbG9jayc7XG5pbXBvcnQgd2l0aEh0bWwgZnJvbSAnLi9wbHVnaW5zL2h0bWwvd2l0aEh0bWwnO1xuXG5mdW5jdGlvbiB2aXN1YWxFZGl0b3JTdHlsZXMoeyBtaW5pbWFsIH0pIHtcbiAgcmV0dXJuIGBcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBvdmVyZmxvdzogYXV0bztcbiAgZm9udC1mYW1pbHk6ICR7Zm9udHMucHJpbWFyeX07XG4gIG1pbi1oZWlnaHQ6ICR7bWluaW1hbCA/ICdhdXRvJyA6IGxlbmd0aHMucmljaFRleHRFZGl0b3JNaW5IZWlnaHR9O1xuICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiAwO1xuICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogMDtcbiAgYm9yZGVyLXRvcDogMDtcbiAgbWFyZ2luLXRvcDogLSR7ZWRpdG9yU3R5bGVWYXJzLnN0aWNreURpc3RhbmNlQm90dG9tfTtcbiAgcGFkZGluZzogMDtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgei1pbmRleDogJHt6SW5kZXguekluZGV4MTAwfTtcbmA7XG59XG5cbmNvbnN0IEluc2VydGlvblBvaW50ID0gc3R5bGVkLmRpdmBcbiAgZmxleDogMSAxIGF1dG87XG4gIGN1cnNvcjogdGV4dDtcbmA7XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZU1lZGlhQ29uZmlnKGVkaXRvckNvbXBvbmVudHMsIGZpZWxkKSB7XG4gIC8vIG1lcmdlIGVkaXRvciBtZWRpYSBsaWJyYXJ5IGNvbmZpZyB0byBpbWFnZSBjb21wb25lbnRzXG4gIGlmIChlZGl0b3JDb21wb25lbnRzLmhhcygnaW1hZ2UnKSkge1xuICAgIGNvbnN0IGltYWdlQ29tcG9uZW50ID0gZWRpdG9yQ29tcG9uZW50cy5nZXQoJ2ltYWdlJyk7XG4gICAgY29uc3QgZmllbGRzID0gaW1hZ2VDb21wb25lbnQ/LmZpZWxkcztcblxuICAgIGlmIChmaWVsZHMpIHtcbiAgICAgIGltYWdlQ29tcG9uZW50LmZpZWxkcyA9IGZpZWxkcy51cGRhdGUoXG4gICAgICAgIGZpZWxkcy5maW5kSW5kZXgoZiA9PiBmLmdldCgnd2lkZ2V0JykgPT09ICdpbWFnZScpLFxuICAgICAgICBmID0+IHtcbiAgICAgICAgICAvLyBtZXJnZSBgbWVkaWFfbGlicmFyeWAgY29uZmlnXG4gICAgICAgICAgaWYgKGZpZWxkLmhhcygnbWVkaWFfbGlicmFyeScpKSB7XG4gICAgICAgICAgICBmID0gZi5zZXQoXG4gICAgICAgICAgICAgICdtZWRpYV9saWJyYXJ5JyxcbiAgICAgICAgICAgICAgZmllbGQuZ2V0KCdtZWRpYV9saWJyYXJ5JykubWVyZ2VEZWVwKGYuZ2V0KCdtZWRpYV9saWJyYXJ5JykpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gbWVyZ2UgJ21lZGlhX2ZvbGRlcidcbiAgICAgICAgICBpZiAoZmllbGQuaGFzKCdtZWRpYV9mb2xkZXInKSAmJiAhZi5oYXMoJ21lZGlhX2ZvbGRlcicpKSB7XG4gICAgICAgICAgICBmID0gZi5zZXQoJ21lZGlhX2ZvbGRlcicsIGZpZWxkLmdldCgnbWVkaWFfZm9sZGVyJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBtZXJnZSAncHVibGljX2ZvbGRlcidcbiAgICAgICAgICBpZiAoZmllbGQuaGFzKCdwdWJsaWNfZm9sZGVyJykgJiYgIWYuaGFzKCdwdWJsaWNfZm9sZGVyJykpIHtcbiAgICAgICAgICAgIGYgPSBmLnNldCgncHVibGljX2ZvbGRlcicsIGZpZWxkLmdldCgncHVibGljX2ZvbGRlcicpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGY7XG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBFZGl0b3IocHJvcHMpIHtcbiAgY29uc3Qge1xuICAgIG9uQWRkQXNzZXQsXG4gICAgZ2V0QXNzZXQsXG4gICAgY2xhc3NOYW1lLFxuICAgIGZpZWxkLFxuICAgIGlzU2hvd01vZGVUb2dnbGUsXG4gICAgdCxcbiAgICBpc0Rpc2FibGVkLFxuICAgIGdldEVkaXRvckNvbXBvbmVudHMsXG4gICAgZ2V0UmVtYXJrUGx1Z2lucyxcbiAgICBvbkNoYW5nZSxcbiAgfSA9IHByb3BzO1xuXG4gIGNvbnN0IGVkaXRvciA9IHVzZU1lbW8oXG4gICAgKCkgPT5cbiAgICAgIHdpdGhIdG1sKFxuICAgICAgICB3aXRoUmVhY3Qod2l0aEhpc3Rvcnkod2l0aFNob3J0Y29kZXMod2l0aEJsb2Nrcyh3aXRoTGlzdHMod2l0aElubGluZXMoY3JlYXRlRWRpdG9yKCkpKSkpKSksXG4gICAgICApLFxuICAgIFtdLFxuICApO1xuXG4gIGNvbnN0IGVtcHR5VmFsdWUgPSBbZGVmYXVsdEVtcHR5QmxvY2soKV07XG4gIGxldCBlZGl0b3JDb21wb25lbnRzID0gZ2V0RWRpdG9yQ29tcG9uZW50cygpO1xuICBjb25zdCBjb2RlQmxvY2tDb21wb25lbnQgPSBmcm9tSlMoZWRpdG9yQ29tcG9uZW50cy5maW5kKCh7IHR5cGUgfSkgPT4gdHlwZSA9PT0gJ2NvZGUtYmxvY2snKSk7XG5cbiAgZWRpdG9yQ29tcG9uZW50cyA9XG4gICAgY29kZUJsb2NrQ29tcG9uZW50IHx8IGVkaXRvckNvbXBvbmVudHMuaGFzKCdjb2RlLWJsb2NrJylcbiAgICAgID8gZWRpdG9yQ29tcG9uZW50c1xuICAgICAgOiBlZGl0b3JDb21wb25lbnRzLnNldCgnY29kZS1ibG9jaycsIHsgbGFiZWw6ICdDb2RlIEJsb2NrJywgdHlwZTogJ2NvZGUtYmxvY2snIH0pO1xuXG4gIG1lcmdlTWVkaWFDb25maWcoZWRpdG9yQ29tcG9uZW50cywgZmllbGQpO1xuXG4gIGNvbnN0IFtlZGl0b3JWYWx1ZSwgc2V0RWRpdG9yVmFsdWVdID0gdXNlU3RhdGUoXG4gICAgcHJvcHMudmFsdWVcbiAgICAgID8gbWFya2Rvd25Ub1NsYXRlKHByb3BzLnZhbHVlLCB7XG4gICAgICAgICAgdm9pZENvZGVCbG9jazogISFjb2RlQmxvY2tDb21wb25lbnQsXG4gICAgICAgICAgcmVtYXJrUGx1Z2luczogZ2V0UmVtYXJrUGx1Z2lucygpLFxuICAgICAgICB9KVxuICAgICAgOiBlbXB0eVZhbHVlLFxuICApO1xuXG4gIGNvbnN0IHJlbmRlckVsZW1lbnQgPSB1c2VDYWxsYmFjayhcbiAgICBwcm9wcyA9PiAoXG4gICAgICA8RWxlbWVudCB7Li4ucHJvcHN9IGNsYXNzTmFtZVdyYXBwZXI9e2NsYXNzTmFtZX0gY29kZUJsb2NrQ29tcG9uZW50PXtjb2RlQmxvY2tDb21wb25lbnR9IC8+XG4gICAgKSxcbiAgICBbXSxcbiAgKTtcbiAgY29uc3QgcmVuZGVyTGVhZiA9IHVzZUNhbGxiYWNrKHByb3BzID0+IDxMZWFmIHsuLi5wcm9wc30gLz4sIFtdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChwcm9wcy5wZW5kaW5nRm9jdXMpIHtcbiAgICAgIFJlYWN0RWRpdG9yLmZvY3VzKGVkaXRvcik7XG4gICAgICBwcm9wcy5wZW5kaW5nRm9jdXMoKTtcbiAgICB9XG4gIH0sIFtwcm9wcy5wZW5kaW5nRm9jdXNdKTtcblxuICBmdW5jdGlvbiBoYW5kbGVNYXJrQ2xpY2soZm9ybWF0KSB7XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgICB0b2dnbGVNYXJrKGVkaXRvciwgZm9ybWF0KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUJsb2NrQ2xpY2soZm9ybWF0KSB7XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgICBpZiAoZm9ybWF0LmVuZHNXaXRoKCctbGlzdCcpKSB7XG4gICAgICBlZGl0b3IudG9nZ2xlTGlzdChmb3JtYXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlZGl0b3IudG9nZ2xlQmxvY2soZm9ybWF0KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVMaW5rQ2xpY2soKSB7XG4gICAgdG9nZ2xlTGluayhlZGl0b3IsIHQoJ2VkaXRvci5lZGl0b3JXaWRnZXRzLm1hcmtkb3duLmxpbmtQcm9tcHQnKSk7XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVRvZ2dsZU1vZGUoKSB7XG4gICAgcHJvcHMub25Nb2RlKCdyYXcnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUluc2VydFNob3J0Y29kZShwbHVnaW5Db25maWcpIHtcbiAgICBpbnNlcnRTaG9ydGNvZGUoZWRpdG9yLCBwbHVnaW5Db25maWcpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlS2V5RG93bihldmVudCkge1xuICAgIGZvciAoY29uc3QgaGFuZGxlciBvZiBlZGl0b3Iua2V5RG93bkhhbmRsZXJzIHx8IFtdKSB7XG4gICAgICBpZiAoaGFuZGxlcihldmVudCwgZWRpdG9yKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIFJlYWN0RWRpdG9yLmZvY3VzKGVkaXRvcik7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVDbGlja0JlbG93RG9jdW1lbnQoKSB7XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgICBUcmFuc2Zvcm1zLnNlbGVjdChlZGl0b3IsIHsgcGF0aDogWzAsIDBdLCBvZmZzZXQ6IDAgfSk7XG4gICAgVHJhbnNmb3Jtcy5zZWxlY3QoZWRpdG9yLCBTbGF0ZUVkaXRvci5lbmQoZWRpdG9yLCBbXSkpO1xuICB9XG4gIGNvbnN0IFt0b29sYmFyS2V5LCBzZXRUb29sYmFyS2V5XSA9IHVzZVN0YXRlKDApO1xuXG4gIGZ1bmN0aW9uIGhhbmRsZUNoYW5nZShuZXdWYWx1ZSkge1xuICAgIGlmICghaXNFcXVhbChuZXdWYWx1ZSwgZWRpdG9yVmFsdWUpKSB7XG4gICAgICBzZXRFZGl0b3JWYWx1ZSgoKSA9PiBuZXdWYWx1ZSk7XG4gICAgICBvbkNoYW5nZShcbiAgICAgICAgc2xhdGVUb01hcmtkb3duKG5ld1ZhbHVlLCB7XG4gICAgICAgICAgdm9pZENvZGVCbG9jazogISFjb2RlQmxvY2tDb21wb25lbnQsXG4gICAgICAgICAgcmVtYXJrUGx1Z2luczogZ2V0UmVtYXJrUGx1Z2lucygpLFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgfVxuICAgIHNldFRvb2xiYXJLZXkocHJldiA9PiBwcmV2ICsgMSk7XG4gIH1cblxuICBmdW5jdGlvbiBoYXNNYXJrKGZvcm1hdCkge1xuICAgIHJldHVybiBpc01hcmtBY3RpdmUoZWRpdG9yLCBmb3JtYXQpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFzSW5saW5lKGZvcm1hdCkge1xuICAgIGlmIChmb3JtYXQgPT0gJ2xpbmsnKSB7XG4gICAgICByZXR1cm4gISFnZXRBY3RpdmVMaW5rKGVkaXRvcik7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhc0Jsb2NrKGZvcm1hdCkge1xuICAgIHJldHVybiBpc0N1cnNvckluQmxvY2tUeXBlKGVkaXRvciwgZm9ybWF0KTtcbiAgfVxuICBmdW5jdGlvbiBoYXNRdW90ZSgpIHtcbiAgICByZXR1cm4gaXNDdXJzb3JJbkJsb2NrVHlwZShlZGl0b3IsICdxdW90ZScpO1xuICB9XG4gIGZ1bmN0aW9uIGhhc0xpc3RJdGVtcyh0eXBlKSB7XG4gICAgcmV0dXJuIGlzQ3Vyc29ySW5CbG9ja1R5cGUoZWRpdG9yLCB0eXBlKTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY3NzPXtjb3JlQ3NzYFxuICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICBgfVxuICAgID5cbiAgICAgIDxTbGF0ZSBlZGl0b3I9e2VkaXRvcn0gdmFsdWU9e2VkaXRvclZhbHVlfSBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfT5cbiAgICAgICAgPEVkaXRvckNvbnRyb2xCYXI+XG4gICAgICAgICAge1xuICAgICAgICAgICAgPFRvb2xiYXJcbiAgICAgICAgICAgICAga2V5PXt0b29sYmFyS2V5fVxuICAgICAgICAgICAgICBvbk1hcmtDbGljaz17aGFuZGxlTWFya0NsaWNrfVxuICAgICAgICAgICAgICBvbkJsb2NrQ2xpY2s9e2hhbmRsZUJsb2NrQ2xpY2t9XG4gICAgICAgICAgICAgIG9uTGlua0NsaWNrPXtoYW5kbGVMaW5rQ2xpY2t9XG4gICAgICAgICAgICAgIG9uVG9nZ2xlTW9kZT17aGFuZGxlVG9nZ2xlTW9kZX1cbiAgICAgICAgICAgICAgcGx1Z2lucz17ZWRpdG9yQ29tcG9uZW50c31cbiAgICAgICAgICAgICAgb25TdWJtaXQ9e2hhbmRsZUluc2VydFNob3J0Y29kZX1cbiAgICAgICAgICAgICAgb25BZGRBc3NldD17b25BZGRBc3NldH1cbiAgICAgICAgICAgICAgZ2V0QXNzZXQ9e2dldEFzc2V0fVxuICAgICAgICAgICAgICBidXR0b25zPXtmaWVsZC5nZXQoJ2J1dHRvbnMnKX1cbiAgICAgICAgICAgICAgZWRpdG9yQ29tcG9uZW50cz17ZmllbGQuZ2V0KCdlZGl0b3JfY29tcG9uZW50cycpfVxuICAgICAgICAgICAgICBoYXNNYXJrPXtoYXNNYXJrfVxuICAgICAgICAgICAgICBoYXNJbmxpbmU9e2hhc0lubGluZX1cbiAgICAgICAgICAgICAgaGFzQmxvY2s9e2hhc0Jsb2NrfVxuICAgICAgICAgICAgICBoYXNRdW90ZT17aGFzUXVvdGV9XG4gICAgICAgICAgICAgIGhhc0xpc3RJdGVtcz17aGFzTGlzdEl0ZW1zfVxuICAgICAgICAgICAgICBpc1Nob3dNb2RlVG9nZ2xlPXtpc1Nob3dNb2RlVG9nZ2xlfVxuICAgICAgICAgICAgICB0PXt0fVxuICAgICAgICAgICAgICBkaXNhYmxlZD17aXNEaXNhYmxlZH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgfVxuICAgICAgICA8L0VkaXRvckNvbnRyb2xCYXI+XG4gICAgICAgIHtcbiAgICAgICAgICA8Q2xhc3NOYW1lcz5cbiAgICAgICAgICAgIHsoeyBjc3MsIGN4IH0pID0+IChcbiAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y3goXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgICAgICAgICAgICBjc3NgXG4gICAgICAgICAgICAgICAgICAgICR7dmlzdWFsRWRpdG9yU3R5bGVzKHsgbWluaW1hbDogZmllbGQuZ2V0KCdtaW5pbWFsJykgfSl9XG4gICAgICAgICAgICAgICAgICBgLFxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7ZWRpdG9yVmFsdWUubGVuZ3RoICE9PSAwICYmIChcbiAgICAgICAgICAgICAgICAgIDxFZGl0YWJsZVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2Nzc2BcbiAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxNnB4IDIwcHggMDtcbiAgICAgICAgICAgICAgICAgICAgYH1cbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyRWxlbWVudD17cmVuZGVyRWxlbWVudH1cbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyTGVhZj17cmVuZGVyTGVhZn1cbiAgICAgICAgICAgICAgICAgICAgb25LZXlEb3duPXtoYW5kbGVLZXlEb3dufVxuICAgICAgICAgICAgICAgICAgICBhdXRvRm9jdXM9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDxJbnNlcnRpb25Qb2ludCBvbkNsaWNrPXtoYW5kbGVDbGlja0JlbG93RG9jdW1lbnR9IC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L0NsYXNzTmFtZXM+XG4gICAgICAgIH1cbiAgICAgIDwvU2xhdGU+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cbkVkaXRvci5wcm9wVHlwZXMgPSB7XG4gIG9uQWRkQXNzZXQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGdldEFzc2V0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25Nb2RlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgdmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGZpZWxkOiBJbW11dGFibGVQcm9wVHlwZXMubWFwLmlzUmVxdWlyZWQsXG4gIGdldEVkaXRvckNvbXBvbmVudHM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGdldFJlbWFya1BsdWdpbnM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGlzU2hvd01vZGVUb2dnbGU6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gIHQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBFZGl0b3I7XG4iXX0= */",
  toString: _EMOTION_STRINGIFIED_CSS_ERROR__
};
function Editor(props) {
  const {
    onAddAsset,
    getAsset,
    className,
    field,
    isShowModeToggle,
    t,
    isDisabled,
    getEditorComponents,
    getRemarkPlugins,
    onChange
  } = props;
  const editor = useMemo(() => withHtml(withReact(withHistory(withShortcodes(withBlocks(withLists(withInlines(createEditor()))))))), []);
  const emptyValue = [defaultEmptyBlock()];
  let editorComponents = getEditorComponents();
  const codeBlockComponent = fromJS(editorComponents.find(({
    type
  }) => type === 'code-block'));
  editorComponents = codeBlockComponent || editorComponents.has('code-block') ? editorComponents : editorComponents.set('code-block', {
    label: 'Code Block',
    type: 'code-block'
  });
  mergeMediaConfig(editorComponents, field);
  const [editorValue, setEditorValue] = useState(props.value ? markdownToSlate(props.value, {
    voidCodeBlock: !!codeBlockComponent,
    remarkPlugins: getRemarkPlugins()
  }) : emptyValue);
  const renderElement = useCallback(props => ___EmotionJSX(Element, _extends({}, props, {
    classNameWrapper: className,
    codeBlockComponent: codeBlockComponent
  })), []);
  const renderLeaf = useCallback(props => ___EmotionJSX(Leaf, props), []);
  useEffect(() => {
    if (props.pendingFocus) {
      ReactEditor.focus(editor);
      props.pendingFocus();
    }
  }, [props.pendingFocus]);
  function handleMarkClick(format) {
    ReactEditor.focus(editor);
    toggleMark(editor, format);
  }
  function handleBlockClick(format) {
    ReactEditor.focus(editor);
    if (format.endsWith('-list')) {
      editor.toggleList(format);
    } else {
      editor.toggleBlock(format);
    }
  }
  function handleLinkClick() {
    toggleLink(editor, t('editor.editorWidgets.markdown.linkPrompt'));
    ReactEditor.focus(editor);
  }
  function handleToggleMode() {
    props.onMode('raw');
  }
  function handleInsertShortcode(pluginConfig) {
    insertShortcode(editor, pluginConfig);
  }
  function handleKeyDown(event) {
    for (const handler of editor.keyDownHandlers || []) {
      if (handler(event, editor) === false) {
        break;
      }
    }
    ReactEditor.focus(editor);
  }
  function handleClickBelowDocument() {
    ReactEditor.focus(editor);
    Transforms.select(editor, {
      path: [0, 0],
      offset: 0
    });
    Transforms.select(editor, SlateEditor.end(editor, []));
  }
  const [toolbarKey, setToolbarKey] = useState(0);
  function handleChange(newValue) {
    if (!isEqual(newValue, editorValue)) {
      setEditorValue(() => newValue);
      onChange(slateToMarkdown(newValue, {
        voidCodeBlock: !!codeBlockComponent,
        remarkPlugins: getRemarkPlugins()
      }));
    }
    setToolbarKey(prev => prev + 1);
  }
  function hasMark(format) {
    return isMarkActive(editor, format);
  }
  function hasInline(format) {
    if (format == 'link') {
      return !!getActiveLink(editor);
    }
    return false;
  }
  function hasBlock(format) {
    return isCursorInBlockType(editor, format);
  }
  function hasQuote() {
    return isCursorInBlockType(editor, 'quote');
  }
  function hasListItems(type) {
    return isCursorInBlockType(editor, type);
  }
  return ___EmotionJSX("div", {
    css: _ref
  }, ___EmotionJSX(Slate, {
    editor: editor,
    value: editorValue,
    onChange: handleChange
  }, ___EmotionJSX(EditorControlBar, null, ___EmotionJSX(Toolbar, {
    key: toolbarKey,
    onMarkClick: handleMarkClick,
    onBlockClick: handleBlockClick,
    onLinkClick: handleLinkClick,
    onToggleMode: handleToggleMode,
    plugins: editorComponents,
    onSubmit: handleInsertShortcode,
    onAddAsset: onAddAsset,
    getAsset: getAsset,
    buttons: field.get('buttons'),
    editorComponents: field.get('editor_components'),
    hasMark: hasMark,
    hasInline: hasInline,
    hasBlock: hasBlock,
    hasQuote: hasQuote,
    hasListItems: hasListItems,
    isShowModeToggle: isShowModeToggle,
    t: t,
    disabled: isDisabled
  })), ___EmotionJSX(ClassNames, null, ({
    css,
    cx
  }) => ___EmotionJSX("div", {
    className: cx(className, css`
                    ${visualEditorStyles({
      minimal: field.get('minimal')
    })}
                  `)
  }, editorValue.length !== 0 && ___EmotionJSX(Editable, {
    className: css`
                      padding: 16px 20px 0;
                    `,
    renderElement: renderElement,
    renderLeaf: renderLeaf,
    onKeyDown: handleKeyDown,
    autoFocus: false
  }), ___EmotionJSX(InsertionPoint, {
    onClick: handleClickBelowDocument
  })))));
}
Editor.propTypes = {
  onAddAsset: PropTypes.func.isRequired,
  getAsset: PropTypes.func.isRequired,
  onChange: PropTypes.func.isRequired,
  onMode: PropTypes.func.isRequired,
  className: PropTypes.string.isRequired,
  value: PropTypes.string,
  field: ImmutablePropTypes.map.isRequired,
  getEditorComponents: PropTypes.func.isRequired,
  getRemarkPlugins: PropTypes.func.isRequired,
  isShowModeToggle: PropTypes.bool.isRequired,
  t: PropTypes.func.isRequired
};
export default Editor;